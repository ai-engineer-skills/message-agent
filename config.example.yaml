# Message Agent Host - Example Configuration

persona:
  name: Assistant
  systemPrompt: |
    You are a helpful AI assistant connected to multiple messaging platforms.
    Be concise and helpful. Use markdown formatting when appropriate.

llm:
  provider: direct-api          # direct-api | copilot | claude-code
  model: gpt-4o
  apiKey: ${LLM_API_KEY}
  baseUrl: https://api.openai.com/v1
  maxTokens: 4096

channels:
  my-telegram:
    type: telegram
    enabled: true
    token: ${TELEGRAM_BOT_TOKEN}

  # my-whatsapp:
  #   type: whatsapp
  #   enabled: false
  #   sessionDataPath: ./data/whatsapp-session

  # my-wechat:
  #   type: wechat
  #   enabled: false
  #   puppetProvider: wechaty-puppet-wechat4u

  # my-imessage:
  #   type: imessage
  #   enabled: false

mcp:
  servers: {}
  # Example:
  # deep-research:
  #   command: node
  #   args: [./path/to/mcp-server.js]
  #   env:
  #     API_KEY: ${RESEARCH_API_KEY}

verification:
  enabled: true
  maxRetries: 3
  confidenceThreshold: 0.7
  skipForShortResponses: true
  shortResponseThreshold: 50
  llmReview:
    enabled: true
    # provider: copilot           # Can use a different provider for review
    # model: gpt-4o-mini          # Can use a cheaper model
  rules:
    enabled: true

skills:
  directories: []
  # - ./my-custom-skills

history:
  dataDir: ./data/history
  maxMessages: 100

# Health monitoring & self-recovery
health:
  heartbeatIntervalMs: 10000         # Write heartbeat to disk every 10s
  heartbeatFile: ./data/heartbeat.json
  httpPort: 3001                     # HTTP /health endpoint port
  httpEnabled: true
  channelCheckIntervalMs: 30000      # Check channel health every 30s
  reconnectBaseDelayMs: 2000         # Initial reconnect delay (doubles per failure)
  reconnectMaxDelayMs: 120000        # Max reconnect backoff: 2 minutes
  maxReconnectAttempts: 10           # Give up after 10 consecutive failures

# To enable external watchdog supervision, run:
#   npm run start:watchdog
#
# Watchdog environment variables:
#   HEARTBEAT_FILE=./data/heartbeat.json
#   HEARTBEAT_TIMEOUT=60             # Restart if no heartbeat for 60s
#   CHECK_INTERVAL=15                # Check every 15s
#   HOST_COMMAND=node dist/index.js
#   MAX_RESTARTS=5                   # Max 5 restarts per window
#   RESTART_WINDOW=300               # 5-minute window
